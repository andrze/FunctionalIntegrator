#include "gaussquadrature.h"
#include "regulator.h"
#include <iostream>
#include <stdexcept>
#include <cmath>
#include <limits>

IntegralConfiguration::IntegralConfiguration(PhysicalDouble start, PhysicalDouble end, size_t n) :
	start(start), end(end), n(n) {
}

GaussQuadrature::GaussQuadrature() {
	d = 0;
}

GaussQuadrature::GaussQuadrature(PhysicalDouble d) :
	d(d) {

	roots[1] = { 0l };
	weights[1] = { 2.0000000000000000000000000l };
	roots[2] = { -0.5773502691896257645091488l, 0.5773502691896257645091488l };
	weights[2] = { 1.0000000000000000000000000l, 1.0000000000000000000000000l };
	roots[3] = { 0l, -0.7745966692414833770358531l, 0.7745966692414833770358531l };
	weights[3] = { 0.8888888888888888888888889l, 0.5555555555555555555555556l, 0.5555555555555555555555556l };
	roots[4] = { -0.3399810435848562648026658l, 0.3399810435848562648026658l, -0.8611363115940525752239465l,
		0.8611363115940525752239465l };
	weights[4] = { 0.6521451548625461426269361l, 0.6521451548625461426269361l, 0.3478548451374538573730639l,
		0.3478548451374538573730639l };
	roots[5] = { 0l, -0.5384693101056830910363144l, 0.5384693101056830910363144l, -0.9061798459386639927976269l,
		0.9061798459386639927976269l };
	weights[5] = { 0.5688888888888888888888889l, 0.4786286704993664680412915l, 0.4786286704993664680412915l,
		0.2369268850561890875142640l, 0.2369268850561890875142640l };
	roots[6] = { -0.2386191860831969086305017l, 0.2386191860831969086305017l, -0.6612093864662645136613996l,
		0.6612093864662645136613996l, -0.9324695142031520278123016l, 0.9324695142031520278123016l };
	weights[6] = { 0.4679139345726910473898703l, 0.4679139345726910473898703l, 0.3607615730481386075698335l,
		0.3607615730481386075698335l, 0.1713244923791703450402961l, 0.1713244923791703450402961l };
	roots[7] = { 0l, -0.4058451513773971669066064l, 0.4058451513773971669066064l, -0.7415311855993944398638648l,
		0.7415311855993944398638648l, -0.9491079123427585245261897l, 0.9491079123427585245261897l };
	weights[7] = { 0.4179591836734693877551020l, 0.3818300505051189449503698l, 0.3818300505051189449503698l,
		0.2797053914892766679014678l, 0.2797053914892766679014678l, 0.1294849661688696932706114l,
		0.1294849661688696932706114l };
	roots[8] = { -0.1834346424956498049394761l, 0.1834346424956498049394761l, -0.5255324099163289858177390l,
		0.5255324099163289858177390l, -0.7966664774136267395915539l, 0.7966664774136267395915539l,
		-0.9602898564975362316835609l, 0.9602898564975362316835609l };
	weights[8] = { 0.3626837833783619829651504l, 0.3626837833783619829651504l, 0.3137066458778872873379622l,
		0.3137066458778872873379622l, 0.2223810344533744705443560l, 0.2223810344533744705443560l,
		0.1012285362903762591525314l, 0.1012285362903762591525314l };
	roots[9] = { 0l, -0.3242534234038089290385380l, 0.3242534234038089290385380l, -0.6133714327005903973087020l,
		0.6133714327005903973087020l, -0.8360311073266357942994298l, 0.8360311073266357942994298l,
		-0.9681602395076260898355762l, 0.9681602395076260898355762l };
	weights[9] = { 0.3302393550012597631645251l, 0.3123470770400028400686304l, 0.3123470770400028400686304l,
		0.2606106964029354623187429l, 0.2606106964029354623187429l, 0.1806481606948574040584720l,
		0.1806481606948574040584720l, 0.0812743883615744119718922l, 0.0812743883615744119718922l };
	roots[10] = { -0.1488743389816312108848260l, 0.1488743389816312108848260l, -0.4333953941292471907992659l,
		0.4333953941292471907992659l, -0.6794095682990244062343274l, 0.6794095682990244062343274l,
		-0.8650633666889845107320967l, 0.8650633666889845107320967l, -0.9739065285171717200779640l,
		0.9739065285171717200779640l };
	weights[10] = { 0.2955242247147528701738930l, 0.2955242247147528701738930l, 0.2692667193099963550912269l,
		0.2692667193099963550912269l, 0.2190863625159820439955349l, 0.2190863625159820439955349l,
		0.1494513491505805931457763l, 0.1494513491505805931457763l, 0.0666713443086881375935688l,
		0.0666713443086881375935688l };
	roots[11] = { 0l, -0.2695431559523449723315320l, 0.2695431559523449723315320l, -0.5190961292068118159257257l,
		0.5190961292068118159257257l, -0.7301520055740493240934163l, 0.7301520055740493240934163l,
		-0.8870625997680952990751578l, 0.8870625997680952990751578l, -0.9782286581460569928039380l,
		0.9782286581460569928039380l };
	weights[11] = { 0.2729250867779006307144835l, 0.2628045445102466621806889l, 0.2628045445102466621806889l,
		0.2331937645919904799185237l, 0.2331937645919904799185237l, 0.1862902109277342514260976l,
		0.1862902109277342514260976l, 0.1255803694649046246346943l, 0.1255803694649046246346943l,
		0.0556685671161736664827537l, 0.0556685671161736664827537l };
	roots[12] = { -0.1252334085114689154724414l, 0.1252334085114689154724414l, -0.3678314989981801937526915l,
		0.3678314989981801937526915l, -0.5873179542866174472967024l, 0.5873179542866174472967024l,
		-0.7699026741943046870368938l, 0.7699026741943046870368938l, -0.9041172563704748566784659l,
		0.9041172563704748566784659l, -0.9815606342467192506905491l, 0.9815606342467192506905491l };
	weights[12] = { 0.2491470458134027850005624l, 0.2491470458134027850005624l, 0.2334925365383548087608499l,
		0.2334925365383548087608499l, 0.2031674267230659217490645l, 0.2031674267230659217490645l,
		0.1600783285433462263346525l, 0.1600783285433462263346525l, 0.1069393259953184309602547l,
		0.1069393259953184309602547l, 0.0471753363865118271946160l, 0.0471753363865118271946160l };
	roots[13] = { 0l, -0.2304583159551347940655281l, 0.2304583159551347940655281l, -0.4484927510364468528779129l,
		0.4484927510364468528779129l, -0.6423493394403402206439846l, 0.6423493394403402206439846l,
		-0.8015780907333099127942065l, 0.8015780907333099127942065l, -0.9175983992229779652065478l,
		0.9175983992229779652065478l, -0.9841830547185881494728294l, 0.9841830547185881494728294l };
	weights[13] = { 0.2325515532308739101945895l, 0.2262831802628972384120902l, 0.2262831802628972384120902l,
		0.2078160475368885023125232l, 0.2078160475368885023125232l, 0.1781459807619457382800467l,
		0.1781459807619457382800467l, 0.1388735102197872384636018l, 0.1388735102197872384636018l,
		0.0921214998377284479144218l, 0.0921214998377284479144218l, 0.0404840047653158795200216l,
		0.0404840047653158795200216l };
	roots[14] = { -0.1080549487073436620662447l, 0.1080549487073436620662447l, -0.3191123689278897604356718l,
		0.3191123689278897604356718l, -0.5152486363581540919652907l, 0.5152486363581540919652907l,
		-0.6872929048116854701480198l, 0.6872929048116854701480198l, -0.8272013150697649931897947l,
		0.8272013150697649931897947l, -0.9284348836635735173363911l, 0.9284348836635735173363911l,
		-0.9862838086968123388415973l, 0.9862838086968123388415973l };
	weights[14] = { 0.2152638534631577901958764l, 0.2152638534631577901958764l, 0.2051984637212956039659241l,
		0.2051984637212956039659241l, 0.1855383974779378137417166l, 0.1855383974779378137417166l,
		0.1572031671581935345696019l, 0.1572031671581935345696019l, 0.1215185706879031846894148l,
		0.1215185706879031846894148l, 0.0801580871597602098056333l, 0.0801580871597602098056333l,
		0.0351194603317518630318329l, 0.0351194603317518630318329l };
	roots[15] = { 0l, -0.2011940939974345223006283l, 0.2011940939974345223006283l, -0.3941513470775633698972074l,
		0.3941513470775633698972074l, -0.5709721726085388475372267l, 0.5709721726085388475372267l,
		-0.7244177313601700474161861l, 0.7244177313601700474161861l, -0.8482065834104272162006483l,
		0.8482065834104272162006483l, -0.9372733924007059043077589l, 0.9372733924007059043077589l,
		-0.9879925180204854284895657l, 0.9879925180204854284895657l };
	weights[15] = { 0.2025782419255612728806202l, 0.1984314853271115764561183l, 0.1984314853271115764561183l,
		0.1861610000155622110268006l, 0.1861610000155622110268006l, 0.1662692058169939335532009l,
		0.1662692058169939335532009l, 0.1395706779261543144478048l, 0.1395706779261543144478048l,
		0.1071592204671719350118695l, 0.1071592204671719350118695l, 0.0703660474881081247092674l,
		0.0703660474881081247092674l, 0.0307532419961172683546284l, 0.0307532419961172683546284l };
	roots[16] = { -0.0950125098376374401853193l, 0.0950125098376374401853193l, -0.2816035507792589132304605l,
		0.2816035507792589132304605l, -0.4580167776572273863424194l, 0.4580167776572273863424194l,
		-0.6178762444026437484466718l, 0.6178762444026437484466718l, -0.7554044083550030338951012l,
		0.7554044083550030338951012l, -0.8656312023878317438804679l, 0.8656312023878317438804679l,
		-0.9445750230732325760779884l, 0.9445750230732325760779884l, -0.9894009349916499325961542l,
		0.9894009349916499325961542l };
	weights[16] = { 0.1894506104550684962853967l, 0.1894506104550684962853967l, 0.1826034150449235888667637l,
		0.1826034150449235888667637l, 0.1691565193950025381893121l, 0.1691565193950025381893121l,
		0.1495959888165767320815017l, 0.1495959888165767320815017l, 0.1246289712555338720524763l,
		0.1246289712555338720524763l, 0.0951585116824927848099251l, 0.0951585116824927848099251l,
		0.0622535239386478928628438l, 0.0622535239386478928628438l, 0.0271524594117540948517806l,
		0.0271524594117540948517806l };
	roots[17] = { 0l, -0.1784841814958478558506775l, 0.1784841814958478558506775l, -0.3512317634538763152971855l,
		0.3512317634538763152971855l, -0.5126905370864769678862466l, 0.5126905370864769678862466l,
		-0.6576711592166907658503022l, 0.6576711592166907658503022l, -0.7815140038968014069252301l,
		0.7815140038968014069252301l, -0.8802391537269859021229557l, 0.8802391537269859021229557l,
		-0.9506755217687677612227170l, 0.9506755217687677612227170l, -0.9905754753144173356754340l,
		0.9905754753144173356754340l };
	weights[17] = { 0.1794464703562065254582656l, 0.1765627053669926463252710l, 0.1765627053669926463252710l,
		0.1680041021564500445099707l, 0.1680041021564500445099707l, 0.1540457610768102880814316l,
		0.1540457610768102880814316l, 0.1351363684685254732863200l, 0.1351363684685254732863200l,
		0.1118838471934039710947884l, 0.1118838471934039710947884l, 0.0850361483171791808835354l,
		0.0850361483171791808835354l, 0.0554595293739872011294402l, 0.0554595293739872011294402l,
		0.0241483028685479319601100l, 0.0241483028685479319601100l };
	roots[18] = { -0.0847750130417353012422619l, 0.0847750130417353012422619l, -0.2518862256915055095889729l,
		0.2518862256915055095889729l, -0.4117511614628426460359318l, 0.4117511614628426460359318l,
		-0.5597708310739475346078715l, 0.5597708310739475346078715l, -0.6916870430603532078748911l,
		0.6916870430603532078748911l, -0.8037049589725231156824175l, 0.8037049589725231156824175l,
		-0.8926024664975557392060606l, 0.8926024664975557392060606l, -0.9558239495713977551811959l,
		0.9558239495713977551811959l, -0.9915651684209309467300160l, 0.9915651684209309467300160l };
	weights[18] = { 0.1691423829631435918406565l, 0.1691423829631435918406565l, 0.1642764837458327229860538l,
		0.1642764837458327229860538l, 0.1546846751262652449254180l, 0.1546846751262652449254180l,
		0.1406429146706506512047313l, 0.1406429146706506512047313l, 0.1225552067114784601845191l,
		0.1225552067114784601845191l, 0.1009420441062871655628140l, 0.1009420441062871655628140l,
		0.0764257302548890565291297l, 0.0764257302548890565291297l, 0.0497145488949697964533349l,
		0.0497145488949697964533349l, 0.0216160135264833103133427l, 0.0216160135264833103133427l };
	roots[19] = { 0l, -0.1603586456402253758680961l, 0.1603586456402253758680961l, -0.3165640999636298319901173l,
		0.3165640999636298319901173l, -0.4645707413759609457172671l, 0.4645707413759609457172671l,
		-0.6005453046616810234696382l, 0.6005453046616810234696382l, -0.7209661773352293786170959l,
		0.7209661773352293786170959l, -0.8227146565371428249789225l, 0.8227146565371428249789225l,
		-0.9031559036148179016426609l, 0.9031559036148179016426609l, -0.9602081521348300308527788l,
		0.9602081521348300308527788l, -0.9924068438435844031890177l, 0.9924068438435844031890177l };
	weights[19] = { 0.1610544498487836959791636l, 0.1589688433939543476499564l, 0.1589688433939543476499564l,
		0.1527660420658596667788554l, 0.1527660420658596667788554l, 0.1426067021736066117757461l,
		0.1426067021736066117757461l, 0.1287539625393362276755158l, 0.1287539625393362276755158l,
		0.1115666455473339947160239l, 0.1115666455473339947160239l, 0.0914900216224499994644621l,
		0.0914900216224499994644621l, 0.0690445427376412265807083l, 0.0690445427376412265807083l,
		0.0448142267656996003328382l, 0.0448142267656996003328382l, 0.0194617882297264770363120l,
		0.0194617882297264770363120l };
	roots[20] = { -0.0765265211334973337546404l, 0.0765265211334973337546404l, -0.2277858511416450780804962l,
		0.2277858511416450780804962l, -0.3737060887154195606725482l, 0.3737060887154195606725482l,
		-0.5108670019508270980043641l, 0.5108670019508270980043641l, -0.6360536807265150254528367l,
		0.6360536807265150254528367l, -0.7463319064601507926143051l, 0.7463319064601507926143051l,
		-0.8391169718222188233945291l, 0.8391169718222188233945291l, -0.9122344282513259058677524l,
		0.9122344282513259058677524l, -0.9639719272779137912676661l, 0.9639719272779137912676661l,
		-0.9931285991850949247861224l, 0.9931285991850949247861224l };
	weights[20] = { 0.1527533871307258506980843l, 0.1527533871307258506980843l, 0.1491729864726037467878287l,
		0.1491729864726037467878287l, 0.1420961093183820513292983l, 0.1420961093183820513292983l,
		0.1316886384491766268984945l, 0.1316886384491766268984945l, 0.1181945319615184173123774l,
		0.1181945319615184173123774l, 0.1019301198172404350367501l, 0.1019301198172404350367501l,
		0.0832767415767047487247581l, 0.0832767415767047487247581l, 0.0626720483341090635695065l,
		0.0626720483341090635695065l, 0.0406014298003869413310400l, 0.0406014298003869413310400l,
		0.0176140071391521183118620l, 0.0176140071391521183118620l };
	roots[21] = { 0l, -0.1455618541608950909370310l, 0.1455618541608950909370310l, -0.2880213168024010966007925l,
		0.2880213168024010966007925l, -0.4243421202074387835736689l, 0.4243421202074387835736689l,
		-0.5516188358872198070590188l, 0.5516188358872198070590188l, -0.6671388041974123193059667l,
		0.6671388041974123193059667l, -0.7684399634756779086158779l, 0.7684399634756779086158779l,
		-0.8533633645833172836472506l, 0.8533633645833172836472506l, -0.9200993341504008287901871l,
		0.9200993341504008287901871l, -0.9672268385663062943166222l, 0.9672268385663062943166222l,
		-0.9937521706203895002602420l, 0.9937521706203895002602420l };
	weights[21] = { 0.1460811336496904271919851l, 0.1445244039899700590638272l, 0.1445244039899700590638272l,
		0.1398873947910731547221334l, 0.1398873947910731547221334l, 0.1322689386333374617810526l,
		0.1322689386333374617810526l, 0.1218314160537285341953672l, 0.1218314160537285341953672l,
		0.1087972991671483776634746l, 0.1087972991671483776634746l, 0.0934444234560338615532897l,
		0.0934444234560338615532897l, 0.0761001136283793020170517l, 0.0761001136283793020170517l,
		0.0571344254268572082836358l, 0.0571344254268572082836358l, 0.0369537897708524937999507l,
		0.0369537897708524937999507l, 0.0160172282577743333242246l, 0.0160172282577743333242246l };
	roots[22] = { -0.0697392733197222212138418l, 0.0697392733197222212138418l, -0.2078604266882212854788465l,
		0.2078604266882212854788465l, -0.3419358208920842251581474l, 0.3419358208920842251581474l,
		-0.4693558379867570264063307l, 0.4693558379867570264063307l, -0.5876404035069115929588769l,
		0.5876404035069115929588769l, -0.6944872631866827800506898l, 0.6944872631866827800506898l,
		-0.7878168059792081620042780l, 0.7878168059792081620042780l, -0.8658125777203001365364256l,
		0.8658125777203001365364256l, -0.9269567721871740005206929l, 0.9269567721871740005206929l,
		-0.9700604978354287271239510l, 0.9700604978354287271239510l, -0.9942945854823992920730314l,
		0.9942945854823992920730314l };
	weights[22] = { 0.1392518728556319933754102l, 0.1392518728556319933754102l, 0.1365414983460151713525738l,
		0.1365414983460151713525738l, 0.1311735047870623707329650l, 0.1311735047870623707329650l,
		0.1232523768105124242855610l, 0.1232523768105124242855610l, 0.1129322960805392183934006l,
		0.1129322960805392183934006l, 0.1004141444428809649320788l, 0.1004141444428809649320788l,
		0.0859416062170677274144437l, 0.0859416062170677274144437l, 0.0697964684245204880949614l,
		0.0697964684245204880949614l, 0.0522933351526832859403121l, 0.0522933351526832859403121l,
		0.0337749015848141547933022l, 0.0337749015848141547933022l, 0.0146279952982722006849911l,
		0.0146279952982722006849911l };
	roots[23] = { 0l, -0.1332568242984661109317427l, 0.1332568242984661109317427l, -0.2641356809703449305338695l,
		0.2641356809703449305338695l, -0.3903010380302908314214889l, 0.3903010380302908314214889l,
		-0.5095014778460075496897930l, 0.5095014778460075496897930l, -0.6196098757636461563850973l,
		0.6196098757636461563850973l, -0.7186613631319501944616245l, 0.7186613631319501944616245l,
		-0.8048884016188398921511184l, 0.8048884016188398921511184l, -0.8767523582704416673781569l,
		0.8767523582704416673781569l, -0.9329710868260161023491970l, 0.9329710868260161023491970l,
		-0.9725424712181152319560241l, 0.9725424712181152319560241l, -0.9947693349975521235239257l,
		0.9947693349975521235239257l };
	weights[23] = { 0.1336545721861061753514571l, 0.1324620394046966173716425l, 0.1324620394046966173716425l,
		0.1289057221880821499785953l, 0.1289057221880821499785953l, 0.1230490843067295304675784l,
		0.1230490843067295304675784l, 0.1149966402224113649416435l, 0.1149966402224113649416435l,
		0.1048920914645414100740862l, 0.1048920914645414100740862l, 0.0929157660600351474770186l,
		0.0929157660600351474770186l, 0.0792814117767189549228925l, 0.0792814117767189549228925l,
		0.0642324214085258521271696l, 0.0642324214085258521271696l, 0.0480376717310846685716411l,
		0.0480376717310846685716411l, 0.0309880058569794443106942l, 0.0309880058569794443106942l,
		0.0134118594871417720813095l, 0.0134118594871417720813095l };
	roots[24] = { -0.0640568928626056260850431l, 0.0640568928626056260850431l, -0.1911188674736163091586398l,
		0.1911188674736163091586398l, -0.3150426796961633743867933l, 0.3150426796961633743867933l,
		-0.4337935076260451384870842l, 0.4337935076260451384870842l, -0.5454214713888395356583756l,
		0.5454214713888395356583756l, -0.6480936519369755692524958l, 0.6480936519369755692524958l,
		-0.7401241915785543642438281l, 0.7401241915785543642438281l, -0.8200019859739029219539499l,
		0.8200019859739029219539499l, -0.8864155270044010342131543l, 0.8864155270044010342131543l,
		-0.9382745520027327585236490l, 0.9382745520027327585236490l, -0.9747285559713094981983920l,
		0.9747285559713094981983920l, -0.9951872199970213601799974l, 0.9951872199970213601799974l };
	weights[24] = { 0.1279381953467521569740562l, 0.1279381953467521569740562l, 0.1258374563468282961213754l,
		0.1258374563468282961213754l, 0.1216704729278033912044632l, 0.1216704729278033912044632l,
		0.1155056680537256013533445l, 0.1155056680537256013533445l, 0.1074442701159656347825773l,
		0.1074442701159656347825773l, 0.0976186521041138882698807l, 0.0976186521041138882698807l,
		0.0861901615319532759171852l, 0.0861901615319532759171852l, 0.0733464814110803057340336l,
		0.0733464814110803057340336l, 0.0592985849154367807463678l, 0.0592985849154367807463678l,
		0.0442774388174198061686027l, 0.0442774388174198061686027l, 0.0285313886289336631813078l,
		0.0285313886289336631813078l, 0.0123412297999871995468057l, 0.0123412297999871995468057l };
	roots[25] = { 0l, -0.1228646926107103963873598l, 0.1228646926107103963873598l, -0.2438668837209884320451904l,
		0.2438668837209884320451904l, -0.3611723058093878377358217l, 0.3611723058093878377358217l,
		-0.4730027314457149605221821l, 0.4730027314457149605221821l, -0.5776629302412229677236898l,
		0.5776629302412229677236898l, -0.6735663684734683644851206l, 0.6735663684734683644851206l,
		-0.7592592630373576305772829l, 0.7592592630373576305772829l, -0.8334426287608340014210211l,
		0.8334426287608340014210211l, -0.8949919978782753688510420l, 0.8949919978782753688510420l,
		-0.9429745712289743394140112l, 0.9429745712289743394140112l, -0.9766639214595175114983154l,
		0.9766639214595175114983154l, -0.9955569697904980979087849l, 0.9955569697904980979087849l };
	weights[25] = { 0.1231760537267154512039029l, 0.1222424429903100416889595l, 0.1222424429903100416889595l,
		0.1194557635357847722281781l, 0.1194557635357847722281781l, 0.1148582591457116483393255l,
		0.1148582591457116483393255l, 0.1085196244742636531160940l, 0.1085196244742636531160940l,
		0.1005359490670506442022069l, 0.1005359490670506442022069l, 0.0910282619829636498114972l,
		0.0910282619829636498114972l, 0.0801407003350010180132350l, 0.0801407003350010180132350l,
		0.0680383338123569172071872l, 0.0680383338123569172071872l, 0.0549046959758351919259369l,
		0.0549046959758351919259369l, 0.0409391567013063126556235l, 0.0409391567013063126556235l,
		0.0263549866150321372619018l, 0.0263549866150321372619018l, 0.0113937985010262879479030l,
		0.0113937985010262879479030l };
	roots[26] = { -0.0592300934293132070937186l, 0.0592300934293132070937186l, -0.1768588203568901839690577l,
		0.1768588203568901839690577l, -0.2920048394859568951428354l, 0.2920048394859568951428354l,
		-0.4030517551234863064810774l, 0.4030517551234863064810774l, -0.5084407148245057176957031l,
		0.5084407148245057176957031l, -0.6066922930176180632319787l, 0.6066922930176180632319787l,
		-0.6964272604199572648638139l, 0.6964272604199572648638139l, -0.7763859488206788561929672l,
		0.7763859488206788561929672l, -0.8454459427884980187975071l, 0.8454459427884980187975071l,
		-0.9026378619843070742176656l, 0.9026378619843070742176656l, -0.9471590666617142501359153l,
		0.9471590666617142501359153l, -0.9783854459564709911005804l, 0.9783854459564709911005804l,
		-0.9958857011456169290032170l, 0.9958857011456169290032170l };
	weights[26] = { 0.1183214152792622765163711l, 0.1183214152792622765163711l, 0.1166604434852965820446625l,
		0.1166604434852965820446625l, 0.1133618165463196665494407l, 0.1133618165463196665494407l,
		0.1084718405285765906565794l, 0.1084718405285765906565794l, 0.1020591610944254232384141l,
		0.1020591610944254232384141l, 0.0942138003559141484636649l, 0.0942138003559141484636649l,
		0.0850458943134852392104478l, 0.0850458943134852392104478l, 0.0746841497656597458870758l,
		0.0746841497656597458870758l, 0.0632740463295748355394537l, 0.0632740463295748355394537l,
		0.0509758252971478119983199l, 0.0509758252971478119983199l, 0.0379623832943627639503031l,
		0.0379623832943627639503031l, 0.0244178510926319087896158l, 0.0244178510926319087896158l,
		0.0105513726173430071556512l, 0.0105513726173430071556512l };
	roots[27] = { 0l, -0.1139725856095299669328950l, 0.1139725856095299669328950l, -0.2264593654395368588572391l,
		0.2264593654395368588572391l, -0.3359939036385088997303190l, 0.3359939036385088997303190l,
		-0.4411482517500268805859742l, 0.4411482517500268805859742l, -0.5405515645794568949003009l,
		0.5405515645794568949003009l, -0.6329079719464951409277346l, 0.6329079719464951409277346l,
		-0.7170134737394236992948162l, 0.7170134737394236992948162l, -0.7917716390705082271443973l,
		0.7917716390705082271443973l, -0.8562079080182944903027372l, 0.8562079080182944903027372l,
		-0.9094823206774911043006450l, 0.9094823206774911043006450l, -0.9509005578147050068519080l,
		0.9509005578147050068519080l, -0.9799234759615012228558734l, 0.9799234759615012228558734l,
		-0.9961792628889885669388872l, 0.9961792628889885669388872l };
	weights[27] = { 0.1142208673789569890450457l, 0.1134763461089651486203699l, 0.1134763461089651486203699l,
		0.1112524883568451926721631l, 0.1112524883568451926721631l, 0.1075782857885331872121630l,
		0.1075782857885331872121630l, 0.1025016378177457986712477l, 0.1025016378177457986712477l,
		0.0960887273700285075656526l, 0.0960887273700285075656526l, 0.0884231585437569501943228l,
		0.0884231585437569501943228l, 0.0796048677730577712630750l, 0.0796048677730577712630750l,
		0.0697488237662455929843229l, 0.0697488237662455929843229l, 0.0589835368598335991103008l,
		0.0589835368598335991103008l, 0.0474494125206150627040967l, 0.0474494125206150627040967l,
		0.0352970537574197110225783l, 0.0352970537574197110225783l, 0.0226862315961806231960342l,
		0.0226862315961806231960342l, 0.0097989960512943602611501l, 0.0097989960512943602611501l };
	roots[28] = { -0.0550792898840342704265165l, 0.0550792898840342704265165l, -0.1645692821333807712814718l,
		0.1645692821333807712814718l, -0.2720616276351780776768264l, 0.2720616276351780776768264l,
		-0.3762515160890787102213572l, 0.3762515160890787102213572l, -0.4758742249551182610344118l,
		0.4758742249551182610344118l, -0.5697204718114017193080033l, 0.5697204718114017193080033l,
		-0.6566510940388649612198982l, 0.6566510940388649612198982l, -0.7356108780136317720281445l,
		0.7356108780136317720281445l, -0.8056413709171791714478860l, 0.8056413709171791714478860l,
		-0.8658925225743950489422546l, 0.8658925225743950489422546l, -0.9156330263921320738696894l,
		0.9156330263921320738696894l, -0.9542592806289381972541018l, 0.9542592806289381972541018l,
		-0.9813031653708727536945599l, 0.9813031653708727536945599l, -0.9964424975739544499504364l,
		0.9964424975739544499504364l };
	weights[28] = { 0.1100470130164751962823763l, 0.1100470130164751962823763l, 0.1087111922582941352535715l,
		0.1087111922582941352535715l, 0.1060557659228464179104164l, 0.1060557659228464179104164l,
		0.1021129675780607698142166l, 0.1021129675780607698142166l, 0.0969306579979299158504890l,
		0.0969306579979299158504890l, 0.0905717443930328409421860l, 0.0905717443930328409421860l,
		0.0831134172289012183903965l, 0.0831134172289012183903965l, 0.0746462142345687790239319l,
		0.0746462142345687790239319l, 0.0652729239669995957933976l, 0.0652729239669995957933976l,
		0.0551073456757167454314829l, 0.0551073456757167454314829l, 0.0442729347590042278395879l,
		0.0442729347590042278395879l, 0.0329014277823043799776308l, 0.0329014277823043799776308l,
		0.0211321125927712597515004l, 0.0211321125927712597515004l, 0.0091242825930945177388162l,
		0.0091242825930945177388162l };
	roots[29] = { 0l, -0.1062782301326792301709824l, 0.1062782301326792301709824l, -0.2113522861660010745063757l,
		0.2113522861660010745063757l, -0.3140316378676399349481959l, 0.3140316378676399349481959l,
		-0.4131528881740086638907066l, 0.4131528881740086638907066l, -0.5075929551242276421026279l,
		0.5075929551242276421026279l, -0.5962817971382278203795862l, 0.5962817971382278203795862l,
		-0.6782145376026865151561850l, 0.6782145376026865151561850l, -0.7524628517344771339126101l,
		0.7524628517344771339126101l, -0.8181854876152524449895722l, 0.8181854876152524449895722l,
		-0.8746378049201027904177934l, 0.8746378049201027904177934l, -0.9211802329530587850937534l,
		0.9211802329530587850937534l, -0.9572855957780877257982080l, 0.9572855957780877257982080l,
		-0.9825455052614131748709260l, 0.9825455052614131748709260l, -0.9966794422605965861631915l,
		0.9966794422605965861631915l };
	weights[29] = { 0.1064793817183142442465111l, 0.1058761550973209414065913l, 0.1058761550973209414065913l,
		0.1040733100777293739133285l, 0.1040733100777293739133285l, 0.1010912737599149661218205l,
		0.1010912737599149661218205l, 0.0969638340944086063019001l, 0.0969638340944086063019001l,
		0.0917377571392587633479664l, 0.0917377571392587633479664l, 0.0854722573661725275453448l,
		0.0854722573661725275453448l, 0.0782383271357637838281449l, 0.0782383271357637838281449l,
		0.0701179332550512785695815l, 0.0701179332550512785695815l, 0.0612030906570791385421098l,
		0.0612030906570791385421098l, 0.0515948269024979239125944l, 0.0515948269024979239125944l,
		0.0414020625186828361048300l, 0.0414020625186828361048300l, 0.0307404922020936226444085l,
		0.0307404922020936226444085l, 0.0197320850561227059838598l, 0.0197320850561227059838598l,
		0.0085169038787464096542638l, 0.0085169038787464096542638l };
	roots[30] = { -0.0514718425553176958330252l, 0.0514718425553176958330252l, -0.1538699136085835469637947l,
		0.1538699136085835469637947l, -0.2546369261678898464398051l, 0.2546369261678898464398051l,
		-0.3527047255308781134710372l, 0.3527047255308781134710372l, -0.4470337695380891767806099l,
		0.4470337695380891767806099l, -0.5366241481420198992641698l, 0.5366241481420198992641698l,
		-0.6205261829892428611404776l, 0.6205261829892428611404776l, -0.6978504947933157969322924l,
		0.6978504947933157969322924l, -0.7677774321048261949179773l, 0.7677774321048261949179773l,
		-0.8295657623827683974428981l, 0.8295657623827683974428981l, -0.8825605357920526815431165l,
		0.8825605357920526815431165l, -0.9262000474292743258793243l, 0.9262000474292743258793243l,
		-0.9600218649683075122168710l, 0.9600218649683075122168710l, -0.9836681232797472099700326l,
		0.9836681232797472099700326l, -0.9968934840746495402716301l, 0.9968934840746495402716301l };
	weights[30] = { 0.1028526528935588403412856l, 0.1028526528935588403412856l, 0.1017623897484055045964290l,
		0.1017623897484055045964290l, 0.0995934205867952670627803l, 0.0995934205867952670627803l,
		0.0963687371746442596394686l, 0.0963687371746442596394686l, 0.0921225222377861287176327l,
		0.0921225222377861287176327l, 0.0868997872010829798023875l, 0.0868997872010829798023875l,
		0.0807558952294202153546949l, 0.0807558952294202153546949l, 0.0737559747377052062682439l,
		0.0737559747377052062682439l, 0.0659742298821804951281285l, 0.0659742298821804951281285l,
		0.0574931562176190664817217l, 0.0574931562176190664817217l, 0.0484026728305940529029381l,
		0.0484026728305940529029381l, 0.0387991925696270495968019l, 0.0387991925696270495968019l,
		0.0287847078833233693497192l, 0.0287847078833233693497192l, 0.0184664683110909591423021l,
		0.0184664683110909591423021l, 0.0079681924961666056154659l, 0.0079681924961666056154659l };
	roots[31] = { 0l, -0.0995553121523415203251748l, 0.0995553121523415203251748l, -0.1981211993355706287724130l,
		0.1981211993355706287724130l, -0.2947180699817016166179039l, 0.2947180699817016166179039l,
		-0.3883859016082329430613515l, 0.3883859016082329430613515l, -0.4781937820449024804405940l,
		0.4781937820449024804405940l, -0.5632491614071492627209449l, 0.5632491614071492627209449l,
		-0.6427067229242603461844182l, 0.6427067229242603461844182l, -0.7157767845868532839059709l,
		0.7157767845868532839059709l, -0.7817331484166249404063600l, 0.7817331484166249404063600l,
		-0.8399203201462673400869045l, 0.8399203201462673400869045l, -0.8897600299482710433741920l,
		0.8897600299482710433741920l, -0.9307569978966481649569458l, 0.9307569978966481649569458l,
		-0.9625039250929496617890524l, 0.9625039250929496617890524l, -0.9846859096651524840024652l,
		0.9846859096651524840024652l, -0.9970874818194770740556266l, 0.9970874818194770740556266l };
	weights[31] = { 0.0997205447934264514275338l, 0.0992250112266723078748755l, 0.0992250112266723078748755l,
		0.0977433353863287250934740l, 0.0977433353863287250934740l, 0.0952902429123195128072042l,
		0.0952902429123195128072042l, 0.0918901138936414782153629l, 0.0918901138936414782153629l,
		0.0875767406084778761261981l, 0.0875767406084778761261981l, 0.0823929917615892639038234l,
		0.0823929917615892639038234l, 0.0763903865987766164263577l, 0.0763903865987766164263577l,
		0.0696285832354103661677561l, 0.0696285832354103661677561l, 0.0621747865610284269103435l,
		0.0621747865610284269103435l, 0.0541030824249168537116663l, 0.0541030824249168537116663l,
		0.0454937075272011029023159l, 0.0454937075272011029023159l, 0.0364322739123854640243920l,
		0.0364322739123854640243920l, 0.0270090191849794218006087l, 0.0270090191849794218006087l,
		0.0173186207903105824631580l, 0.0173186207903105824631580l, 0.0074708315792487758586969l,
		0.0074708315792487758586969l };
	roots[32] = { -0.0483076656877383162348126l, 0.0483076656877383162348126l, -0.1444719615827964934851864l,
		0.1444719615827964934851864l, -0.2392873622521370745446032l, 0.2392873622521370745446032l,
		-0.3318686022821276497799168l, 0.3318686022821276497799168l, -0.4213512761306353453641194l,
		0.4213512761306353453641194l, -0.5068999089322293900237475l, 0.5068999089322293900237475l,
		-0.5877157572407623290407455l, 0.5877157572407623290407455l, -0.6630442669302152009751152l,
		0.6630442669302152009751152l, -0.7321821187402896803874267l, 0.7321821187402896803874267l,
		-0.7944837959679424069630973l, 0.7944837959679424069630973l, -0.8493676137325699701336930l,
		0.8493676137325699701336930l, -0.8963211557660521239653072l, 0.8963211557660521239653072l,
		-0.9349060759377396891709191l, 0.9349060759377396891709191l, -0.9647622555875064307738119l,
		0.9647622555875064307738119l, -0.9856115115452683354001750l, 0.9856115115452683354001750l,
		-0.9972638618494815635449811l, 0.9972638618494815635449811l };
	weights[32] = { 0.0965400885147278005667648l, 0.0965400885147278005667648l, 0.0956387200792748594190820l,
		0.0956387200792748594190820l, 0.0938443990808045656391802l, 0.0938443990808045656391802l,
		0.0911738786957638847128686l, 0.0911738786957638847128686l, 0.0876520930044038111427715l,
		0.0876520930044038111427715l, 0.0833119242269467552221991l, 0.0833119242269467552221991l,
		0.0781938957870703064717409l, 0.0781938957870703064717409l, 0.0723457941088485062253994l,
		0.0723457941088485062253994l, 0.0658222227763618468376501l, 0.0658222227763618468376501l,
		0.0586840934785355471452836l, 0.0586840934785355471452836l, 0.0509980592623761761961632l,
		0.0509980592623761761961632l, 0.0428358980222266806568786l, 0.0428358980222266806568786l,
		0.0342738629130214331026877l, 0.0342738629130214331026877l, 0.0253920653092620594557526l,
		0.0253920653092620594557526l, 0.0162743947309056706051706l, 0.0162743947309056706051706l,
		0.0070186100094700966004071l, 0.0070186100094700966004071l };
	roots[33] = { 0l, -0.0936310658547333856707429l, 0.0936310658547333856707429l, -0.1864392988279915723357988l,
		0.1864392988279915723357988l, -0.2776090971524970294032481l, 0.2776090971524970294032481l,
		-0.3663392577480733410702206l, 0.3663392577480733410702206l, -0.4518500172724506957259933l,
		0.4518500172724506957259933l, -0.5333899047863476435488943l, 0.5333899047863476435488943l,
		-0.6102423458363790273072875l, 0.6102423458363790273072875l, -0.6817319599697427862682159l,
		0.6817319599697427862682159l, -0.7472304964495621578590551l, 0.7472304964495621578590551l,
		-0.8061623562741665897962009l, 0.8061623562741665897962009l, -0.8580096526765040646430615l,
		0.8580096526765040646430615l, -0.9023167677434335830405313l, 0.9023167677434335830405313l,
		-0.9386943726111683503558351l, 0.9386943726111683503558351l, -0.9668229096899927689283777l,
		0.9668229096899927689283777l, -0.9864557262306424881103757l, 0.9864557262306424881103757l,
		-0.9974246942464552172661680l, 0.9974246942464552172661680l };
	weights[33] = { 0.0937684461602099965673045l, 0.0933564260655961161609991l, 0.0933564260655961161609991l,
		0.0921239866433168462132410l, 0.0921239866433168462132410l, 0.0900819586606385772397437l,
		0.0900819586606385772397437l, 0.0872482876188443376072817l, 0.0872482876188443376072817l,
		0.0836478760670387076139280l, 0.0836478760670387076139280l, 0.0793123647948867383639084l,
		0.0793123647948867383639084l, 0.0742798548439541493424722l, 0.0742798548439541493424722l,
		0.0685945728186567128059551l, 0.0685945728186567128059551l, 0.0623064825303174800316277l,
		0.0623064825303174800316277l, 0.0554708466316635612849445l, 0.0554708466316635612849445l,
		0.0481477428187116956701469l, 0.0481477428187116956701469l, 0.0404015413316695915634098l,
		0.0404015413316695915634098l, 0.0323003586323289532815614l, 0.0323003586323289532815614l,
		0.0239155481017494803505333l, 0.0239155481017494803505333l, 0.0153217015129346761279458l,
		0.0153217015129346761279458l, 0.0066062278475873780586492l, 0.0066062278475873780586492l };
	roots[34] = { -0.0455098219531025427490757l, 0.0455098219531025427490757l, -0.1361523572591829758944288l,
		0.1361523572591829758944288l, -0.2256666916164494838686412l, 0.2256666916164494838686412l,
		-0.3133110813394632474583168l, 0.3133110813394632474583168l, -0.3983592777586459406314948l,
		0.3983592777586459406314948l, -0.4801065451903270341941027l, 0.4801065451903270341941027l,
		-0.5578755006697466427364599l, 0.5578755006697466427364599l, -0.6310217270805285453177758l,
		0.6310217270805285453177758l, -0.6989391132162629079330001l, 0.6989391132162629079330001l,
		-0.7610648766298730141874090l, 0.7610648766298730141874090l, -0.8168842279009336645915789l,
		0.8168842279009336645915789l, -0.8659346383345644692635721l, 0.8659346383345644692635721l,
		-0.9078096777183244688008999l, 0.9078096777183244688008999l, -0.9421623974051070916316760l,
		0.9421623974051070916316760l, -0.9687082625333442817646466l, 0.9687082625333442817646466l,
		-0.9872278164063094850497504l, 0.9872278164063094850497504l, -0.9975717537908419192433724l,
		0.9975717537908419192433724l };
	weights[34] = { 0.0909567403302598736153376l, 0.0909567403302598736153376l, 0.0902030443706407295739422l,
		0.0902030443706407295739422l, 0.0887018978356938692870765l, 0.0887018978356938692870765l,
		0.0864657397470357497842469l, 0.0864657397470357497842469l, 0.0835130996998456551870202l,
		0.0835130996998456551870202l, 0.0798684443397718447388188l, 0.0798684443397718447388188l,
		0.0755619746600319312708340l, 0.0755619746600319312708340l, 0.0706293758142557249990388l,
		0.0706293758142557249990388l, 0.0651115215540764113785444l, 0.0651115215540764113785444l,
		0.0590541358275244931939610l, 0.0590541358275244931939610l, 0.0525074145726781061682460l,
		0.0525074145726781061682460l, 0.0455256115233532724538226l, 0.0455256115233532724538226l,
		0.0381665937963875163217659l, 0.0381665937963875163217659l, 0.0304913806384461318094424l,
		0.0304913806384461318094424l, 0.0225637219854949700840941l, 0.0225637219854949700840941l,
		0.0144501627485950354152022l, 0.0144501627485950354152022l, 0.0062291405559086847186065l,
		0.0062291405559086847186065l };
	roots[35] = { 0l, -0.0883713432756592636009294l, 0.0883713432756592636009294l, -0.1760510611659895699743037l,
		0.1760510611659895699743037l, -0.2623529412092960579708952l, 0.2623529412092960579708952l,
		-0.3466015544308139458769798l, 0.3466015544308139458769798l, -0.4281375415178142541876206l,
		0.4281375415178142541876206l, -0.5063227732414886150242976l, 0.5063227732414886150242976l,
		-0.5805453447497645099345020l, 0.5805453447497645099345020l, -0.6502243646658903886757928l,
		0.6502243646658903886757928l, -0.7148145015566287832644086l, 0.7148145015566287832644086l,
		-0.7738102522869125552674230l, 0.7738102522869125552674230l, -0.8267498990922254068340506l,
		0.8267498990922254068340506l, -0.8732191250252223315232823l, 0.8732191250252223315232823l,
		-0.9128542613593176144649371l, 0.9128542613593176144649371l, -0.9453451482078273295387260l,
		0.9453451482078273295387260l, -0.9704376160392298332150705l, 0.9704376160392298332150705l,
		-0.9879357644438514980351171l, 0.9879357644438514980351171l, -0.9977065690996002972601631l,
		0.9977065690996002972601631l };
	weights[35] = { 0.0884867949071042906382074l, 0.0881405304302754629707388l, 0.0881405304302754629707388l,
		0.0871044469971835342433220l, 0.0871044469971835342433220l, 0.0853866533920991252259440l,
		0.0853866533920991252259440l, 0.0830005937288565883799265l, 0.0830005937288565883799265l,
		0.0799649422423242629326621l, 0.0799649422423242629326621l, 0.0763034571554420535386585l,
		0.0763034571554420535386585l, 0.0720447947725600646654619l, 0.0720447947725600646654619l,
		0.0672222852690869039643055l, 0.0672222852690869039643055l, 0.0618736719660801888870141l,
		0.0618736719660801888870141l, 0.0560408162123701285783277l, 0.0560408162123701285783277l,
		0.0497693704013535298051997l, 0.0497693704013535298051997l, 0.0431084223261702187823065l,
		0.0431084223261702187823065l, 0.0361101158634633805327170l, 0.0361101158634633805327170l,
		0.0288292601088942540487160l, 0.0288292601088942540487160l, 0.0213229799114835808834380l,
		0.0213229799114835808834380l, 0.0136508283483614922664040l, 0.0136508283483614922664040l,
		0.0058834334204430849757539l, 0.0058834334204430849757539l };
	roots[36] = { -0.0430181984737086072269690l, 0.0430181984737086072269690l, -0.1287361038093847886519934l,
		0.1287361038093847886519934l, -0.2135008923168655789432262l, 0.2135008923168655789432262l,
		-0.2966849953440282705032390l, 0.2966849953440282705032390l, -0.3776725471196892163227364l,
		0.3776725471196892163227364l, -0.4558639444334202672072177l, 0.4558639444334202672072177l,
		-0.5306802859262451616407091l, 0.5306802859262451616407091l, -0.6015676581359805350799450l,
		0.6015676581359805350799450l, -0.6680012365855210620971913l, 0.6680012365855210620971913l,
		-0.7294891715935565820902605l, 0.7294891715935565820902605l, -0.7855762301322065128277690l,
		0.7855762301322065128277690l, -0.8358471669924753064188209l, 0.8358471669924753064188209l,
		-0.8799298008903971319824273l, 0.8799298008903971319824273l, -0.9174977745156590660758672l,
		0.9174977745156590660758672l, -0.9482729843995075452024741l, 0.9482729843995075452024741l,
		-0.9720276910496979493356050l, 0.9720276910496979493356050l, -0.9885864789022122380733951l,
		0.9885864789022122380733951l, -0.9978304624840858361988283l, 0.9978304624840858361988283l };
	weights[36] = { 0.0859832756703947474900852l, 0.0859832756703947474900852l, 0.0853466857393386274918505l,
		0.0853466857393386274918505l, 0.0840782189796619349334576l, 0.0840782189796619349334576l,
		0.0821872667043397095172235l, 0.0821872667043397095172235l, 0.0796878289120716019087247l,
		0.0796878289120716019087247l, 0.0765984106458706745287577l, 0.0765984106458706745287577l,
		0.0729418850056530613538734l, 0.0729418850056530613538734l, 0.0687453238357364426136896l,
		0.0687453238357364426136896l, 0.0640397973550154895563848l, 0.0640397973550154895563848l,
		0.0588601442453248173096754l, 0.0588601442453248173096754l, 0.0532447139777599190920256l,
		0.0532447139777599190920256l, 0.0472350834902659784166168l, 0.0472350834902659784166168l,
		0.0408757509236448954741145l, 0.0408757509236448954741145l, 0.0342138107703072299212451l,
		0.0342138107703072299212451l, 0.0272986214985687790944172l, 0.0272986214985687790944172l,
		0.0201815152977354715320989l, 0.0201815152977354715320989l, 0.0129159472840655744045034l,
		0.0129159472840655744045034l, 0.0055657196642450453612560l, 0.0055657196642450453612560l };
	roots[37] = { 0l, -0.0836704089547699019430483l, 0.0836704089547699019430483l, -0.1667539302398519769686717l,
		0.1667539302398519769686717l, -0.2486677927913657588055678l, 0.2486677927913657588055678l,
		-0.3288374298837069994984718l, 0.3288374298837069994984718l, -0.4067005093183261101009316l,
		0.4067005093183261101009316l, -0.4817108778032055541471929l, 0.4817108778032055541471929l,
		-0.5533423918615817812350984l, 0.5533423918615817812350984l, -0.6210926084089244831481526l,
		0.6210926084089244831481526l, -0.6844863091309593574455232l, 0.6844863091309593574455232l,
		-0.7430788339819652625470474l, 0.7430788339819652625470474l, -0.7964592005099022933930463l,
		0.7964592005099022933930463l, -0.8442529873405559679874563l, 0.8442529873405559679874563l,
		-0.8861249621554860789461495l, 0.8861249621554860789461495l, -0.9217814374124637426681437l,
		0.9217814374124637426681437l, -0.9509723432620948213285761l, 0.9509723432620948213285761l,
		-0.9734930300564857443288905l, 0.9734930300564857443288905l, -0.9891859632143191866840991l,
		0.9891859632143191866840991l, -0.9979445824779136489408031l, 0.9979445824779136489408031l };
	weights[37] = { 0.0837683609931389047970174l, 0.0834745736258627872522530l, 0.0834745736258627872522530l,
		0.0825952722364372508912303l, 0.0825952722364372508912303l, 0.0811366245084650305098776l,
		0.0811366245084650305098776l, 0.0791088618375293807672122l, 0.0791088618375293807672122l,
		0.0765262075705292378858880l, 0.0765262075705292378858880l, 0.0734067772484881727246266l,
		0.0734067772484881727246266l, 0.0697724515557003448850814l, 0.0697724515557003448850814l,
		0.0656487228727512494840238l, 0.0656487228727512494840238l, 0.0610645165232259861309881l,
		0.0610645165232259861309881l, 0.0560519879982749178085392l, 0.0560519879982749178085392l,
		0.0506462976548246016038759l, 0.0506462976548246016038759l, 0.0448853646624371666574103l,
		0.0448853646624371666574103l, 0.0388096025019345444889624l, 0.0388096025019345444889624l,
		0.0324616398475214810672343l, 0.0324616398475214810672343l, 0.0258860369905589335227595l,
		0.0258860369905589335227595l, 0.0191290444890839660435019l, 0.0191290444890839660435019l,
		0.0122387801003075565263049l, 0.0122387801003075565263049l, 0.0052730572794979393517221l,
		0.0052730572794979393517221l };
	roots[38] = { -0.0407851479045782399133164l, 0.0407851479045782399133164l, -0.1220840253378674198696124l,
		0.1220840253378674198696124l, -0.2025704538921167032039778l, 0.2025704538921167032039778l,
		-0.2817088097901652613601141l, 0.2817088097901652613601141l, -0.3589724404794350132567176l,
		0.3589724404794350132567176l, -0.4338471694323764843732562l, 0.4338471694323764843732562l,
		-0.5058347179279311032405337l, 0.5058347179279311032405337l, -0.5744560210478070811329275l,
		0.5744560210478070811329275l, -0.6392544158296817071803449l, 0.6392544158296817071803449l,
		-0.6997986803791843559128258l, 0.6997986803791843559128258l, -0.7556859037539706807377381l,
		0.7556859037539706807377381l, -0.8065441676053168155515654l, 0.8065441676053168155515654l,
		-0.8520350219323621888596497l, 0.8520350219323621888596497l, -0.8918557390046322167949370l,
		0.8918557390046322167949370l, -0.9257413320485843968251096l, 0.9257413320485843968251096l,
		-0.9534663309335295956705422l, 0.9534663309335295956705422l, -0.9748463285901535076408855l,
		0.9748463285901535076408855l, -0.9897394542663855719444259l, 0.9897394542663855719444259l,
		-0.9980499305356876198128471l, 0.9980499305356876198128471l };
	weights[38] = { 0.0815250292803857866992188l, 0.0815250292803857866992188l, 0.0809824937705971006232695l,
		0.0809824937705971006232695l, 0.0799010332435278215860277l, 0.0799010332435278215860277l,
		0.0782878446582109480753754l, 0.0782878446582109480753754l, 0.0761536635484463960659935l,
		0.0761536635484463960659935l, 0.0735126925847434571452064l, 0.0735126925847434571452064l,
		0.0703825070668989547392830l, 0.0703825070668989547392830l, 0.0667839379791404119350462l,
		0.0667839379791404119350462l, 0.0627409333921330540529697l, 0.0627409333921330540529697l,
		0.0582803991469972060223059l, 0.0582803991469972060223059l, 0.0534320199103323199737570l,
		0.0534320199103323199737570l, 0.0482280618607586833743522l, 0.0482280618607586833743522l,
		0.0427031585046744342358784l, 0.0427031585046744342358784l, 0.0368940815940247381649402l,
		0.0368940815940247381649402l, 0.0308395005451750546587311l, 0.0308395005451750546587311l,
		0.0245797397382323758952012l, 0.0245797397382323758952012l, 0.0181565777096132368988761l,
		0.0181565777096132368988761l, 0.0116134447164686741776683l, 0.0116134447164686741776683l,
		0.0050028807496393456758995l, 0.0050028807496393456758995l };
	roots[39] = { 0l, -0.0794438046087554775819171l, 0.0794438046087554775819171l, -0.1583853399978377999227011l,
		0.1583853399978377999227011l, -0.2363255124618357673360063l, 0.2363255124618357673360063l,
		-0.3127715592481859225359969l, 0.3127715592481859225359969l, -0.3872401639715614558538820l,
		0.3872401639715614558538820l, -0.4592605123091360486632466l, 0.4592605123091360486632466l,
		-0.5283772686604374738963436l, 0.5283772686604374738963436l, -0.5941534549572779886928901l,
		0.5941534549572779886928901l, -0.6561732134320109107344259l, 0.6561732134320109107344259l,
		-0.7140444358945346791338670l, 0.7140444358945346791338670l, -0.7674012429310634998322724l,
		0.7674012429310634998322724l, -0.8159062974301431043532327l, 0.8159062974301431043532327l,
		-0.8592529379999061539137974l, 0.8592529379999061539137974l, -0.8971671192929928878482911l,
		0.8971671192929928878482911l, -0.9294091484867382296978170l, 0.9294091484867382296978170l,
		-0.9557752123246522771108919l, 0.9557752123246522771108919l, -0.9760987093334710538448503l,
		0.9760987093334710538448503l, -0.9902515368546859836397751l, 0.9902515368546859836397751l,
		-0.9981473830664329060054723l, 0.9981473830664329060054723l };
	weights[39] = { 0.0795276221394428524174182l, 0.0792762225683684710101558l, 0.0792762225683684710101558l,
		0.0785236132873711767250633l, 0.0785236132873711767250633l, 0.0772745525446820167285116l,
		0.0772745525446820167285116l, 0.0755369373228360577047844l, 0.0755369373228360577047844l,
		0.0733217534142686173811539l, 0.0733217534142686173811539l, 0.0706430059706087607701149l,
		0.0706430059706087607701149l, 0.0675176309662312653630213l, 0.0675176309662312653630213l,
		0.0639653881386823889867064l, 0.0639653881386823889867064l, 0.0600087360885961495749418l,
		0.0600087360885961495749418l, 0.0556726903409162999073911l, 0.0556726903409162999073911l,
		0.0509846652921294052140210l, 0.0509846652921294052140210l, 0.0459743011089166318841766l,
		0.0459743011089166318841766l, 0.0406732768479338439390566l, 0.0406732768479338439390566l,
		0.0351151114981313307610652l, 0.0351151114981313307610652l, 0.0293349559839033785921560l,
		0.0293349559839033785921560l, 0.0233693848321781645947123l, 0.0233693848321781645947123l,
		0.0172562290937249190408055l, 0.0172562290937249190408055l, 0.0110347889391645942426768l,
		0.0110347889391645942426768l, 0.0047529446916351013707762l, 0.0047529446916351013707762l };
	roots[40] = { -0.0387724175060508219331934l, 0.0387724175060508219331934l, -0.1160840706752552084834513l,
		0.1160840706752552084834513l, -0.1926975807013710997155169l, 0.1926975807013710997155169l,
		-0.2681521850072536811411843l, 0.2681521850072536811411843l, -0.3419940908257584730074925l,
		0.3419940908257584730074925l, -0.4137792043716050015248797l, 0.4137792043716050015248797l,
		-0.4830758016861787129085666l, 0.4830758016861787129085666l, -0.5494671250951282020759313l,
		0.5494671250951282020759313l, -0.6125538896679802379526125l, 0.6125538896679802379526125l,
		-0.6719566846141795483793545l, 0.6719566846141795483793545l, -0.7273182551899271032809965l,
		0.7273182551899271032809965l, -0.7783056514265193876949715l, 0.7783056514265193876949715l,
		-0.8246122308333116631963202l, 0.8246122308333116631963202l, -0.8659595032122595038207818l,
		0.8659595032122595038207818l, -0.9020988069688742967282533l, 0.9020988069688742967282533l,
		-0.9328128082786765333608522l, 0.9328128082786765333608522l, -0.9579168192137916558045410l,
		0.9579168192137916558045410l, -0.9772599499837742626633703l, 0.9772599499837742626633703l,
		-0.9907262386994570064530544l, 0.9907262386994570064530544l, -0.9982377097105592003496227l,
		0.9982377097105592003496227l };
	weights[40] = { 0.0775059479784248112637240l, 0.0775059479784248112637240l, 0.0770398181642479655883075l,
		0.0770398181642479655883075l, 0.0761103619006262423715581l, 0.0761103619006262423715581l,
		0.0747231690579682642001893l, 0.0747231690579682642001893l, 0.0728865823958040590605107l,
		0.0728865823958040590605107l, 0.0706116473912867796954836l, 0.0706116473912867796954836l,
		0.0679120458152339038256901l, 0.0679120458152339038256901l, 0.0648040134566010380745545l,
		0.0648040134566010380745545l, 0.0613062424929289391665380l, 0.0613062424929289391665380l,
		0.0574397690993915513666177l, 0.0574397690993915513666177l, 0.0532278469839368243549965l,
		0.0532278469839368243549965l, 0.0486958076350722320614342l, 0.0486958076350722320614342l,
		0.0438709081856732719916747l, 0.0438709081856732719916747l, 0.0387821679744720176399720l,
		0.0387821679744720176399720l, 0.0334601952825478473926782l, 0.0334601952825478473926782l,
		0.0279370069800234010984892l, 0.0279370069800234010984892l, 0.0222458491941669572615043l,
		0.0222458491941669572615043l, 0.0164210583819078887128635l, 0.0164210583819078887128635l,
		0.0104982845311528136147422l, 0.0104982845311528136147422l, 0.0045212770985331912584717l,
		0.0045212770985331912584717l };

	if (std::abs(d-2) < std::numeric_limits<PhysicalDouble>::epsilon()) {
		configurations = { { 0, .05l, 40 }, { 0.05l, .3l, 30 }, { .3l, 1, 40 }, { 1, 3, 20 }, { 3, 15, 20 } };
	} else {
		configurations = { { 0, 0.1, 40 }, { 0.1, 3., 40 }, { 3., 7., 20 } };
	}

	for (auto &&config : configurations) {
		std::vector<std::array<PhysicalDouble, 6> > one_config_eval_points;
		for (size_t k = 0; k < config.n; k++) {
			PhysicalDouble point = (config.start + config.end) / 2
				+ (config.end - config.start) * roots[config.n][k] / 2;
			PhysicalDouble y2;
			std::array<PhysicalDouble, 6> eval_point;
			if (std::abs(d-2) < std::numeric_limits<PhysicalDouble>::epsilon()) {
				y2 = point;
				eval_point = { y2, 1.l / 2, R(y2) / 2, Rp(y2) / 2, Rp2(y2) / 2, Prefactor(y2) / 2 };
			} else {
				y2 = point * point;
				eval_point = { y2, std::pow(point, d - 1), R(y2) / 2, Rp(y2) / 2, Rp2(y2) / 2, Prefactor(y2) / 2 };
			}

			one_config_eval_points.push_back(eval_point);
		}
		evaluation_points.push_back(one_config_eval_points);
	}
}

PhysicalDouble GaussQuadrature::partial_integrate(std::function<PhysicalDouble(std::array<PhysicalDouble, 6>)> &f,
	size_t configuration_index) const {
	const IntegralConfiguration &conf = configurations[configuration_index];
	const PhysicalDouble &b = conf.end, a = conf.start;
	const size_t &n = conf.n;
	if (n == 0) {
		throw(std::invalid_argument("Number of integration points must be positive"));
	}
	if (n > 40) {
		throw(std::invalid_argument("Number of integration points larger than 40 not implemented"));
	}

	PhysicalDouble sum = 0;
	for (size_t k = 0; k < n; k++) {
		sum += weights[n][k] * f(evaluation_points[configuration_index][k]);
	}

	return sum * (b - a) / 2;
}
/*
 PhysicalDouble GaussQuadrature::integrate(std::function<PhysicalDouble(PhysicalDouble)> f) const {
 PhysicalDouble integral = 0;

 for (size_t k = 0; k < configurations.size(); k++) {
 integral += partial_integrate(f, k);
 }

 return integral;
 }*/

PhysicalDouble GaussQuadrature::integrate(std::function<PhysicalDouble(std::array<PhysicalDouble, 6>)> &f) const {
	PhysicalDouble integral = 0;

	for (size_t k = 0; k < configurations.size(); k++) {
		integral += partial_integrate(f, k);
	}

	return integral;
}

